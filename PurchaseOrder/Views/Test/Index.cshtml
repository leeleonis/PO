  <!--表單↓通常放置查詢條件-->
<!--action在這裡可以不用給，因為發出ajax時就會指派url-->
<form name="myForm" action="" method="post">
    <label>MyTitle:</label> <input type="text" name="MyTitle" /><br />
    <label>MyMoney:</label> <input type="text" name="MyMoney" /><br />
    <input type="button" id="btnQuery" value="查詢" />

    <div id="msgInProgress">
        <div id="mySpinner" style="width:32px;height:32px"></div>
        <br />
        <h3>Detecting WCPP utility at client side...</h3>
        <h3>Please wait a few seconds...</h3>
        <br />
    </div>
    <div id="msgInstallWCPP">
        <h3>#1 Install WebClientPrint Processor (WCPP)!</h3>
        <p>
            <strong>WCPP is a native app (without any dependencies!)</strong> that handles all print jobs
            generated by the <strong>WebClientPrint for ASP.NET component</strong> at the server side. The WCPP
            is in charge of the whole printing process and can be
            installed on <strong>Windows, Linux, Mac & Raspberry Pi!</strong>
        </p>
        <p>
            <a href="//www.neodynamic.com/downloads/wcpp/" target="_blank">Download and Install WCPP from Neodynamic website</a><br />
        </p>
        <h3>#2 After installing WCPP...</h3>
        <p>
            <a href="@Url.Action("Index")">You can go and test the printing page...</a>
        </p>
        <h1>How to print multiple files to client printers from ASP.NET</h1>
        Please change the source code to match your printer names and files to test it locally
        <br /><br />
        <input type="button" style="font-size:18px" onclick="javascript:jsWebClientPrint.print('pagesRange=1');" value="Print Files...1" />
        <input type="button" style="font-size:18px" onclick="javascript:jsWebClientPrint.print('pagesRange=2');" value="Print Files...2" />
    </div>
</form>

<form name="myForm" action="WinitByexcel" method="post" enctype = "multipart/form-data">

    <input type="file" name="ExcelFile" />
    <button type="submit">送出</button>
</form>

<!--DataTables的表格-->
<table id="myDataTalbe" class="table table-bordered table-striped text-center dataTable no-footer">
    <thead>
        <tr>
            <th>#</th>
            <th>MyTitle</th>
            <th>MyMoney</th>
        </tr>
    </thead>
</table>
@*@section pagespecific {
        <script type="text/javascript">
            $(function () {

                 let table =
                     $("#myDataTalbe").DataTable({
                         /* processing: true,*/  //→這太醜了，所以關閉
                         searching: false,  //關閉filter功能
                         columns: [ //指定Server端的資料行繫結名稱
                             { data: "sysid" },
                             { data: "MyTitle" },
                             { data: "MyMoney" }
                         ],
                         serverSide: true,//啟用ServerSide模式
                         //ajax參數在1.9版以前參數名稱為sAjaxSource
                         ajax: {
                             method:"get",//或post，自由決定，影響到Server端用FormCollection取值或Request.QueryString取得DataTables傳遞的資訊
                             url: "@Url.Action("GetData_Full")",
                             data: function (d)
                             {
                                 d.MyTitle = $("input[name=MyTitle]").val();
                                 d.MyMoney = $("input[name=MyMoney]").val();
                             }
                         },
                         deferLoading: 0, //初始化DataTable時，不發出ajax
                         order: [[0, "asc"]], //預設排序資料行(由0算起)
                         orderMulti : false
                     });

                $("#btnQuery").click(function () {
                     //按下表單的查詢按鈕後才發出Ajax載入資料
                     table.draw(); //或table.ajax.reload();

                });
            });
        </script>
    }*@

@section pagespecific {

    <script type="text/javascript">

    var wcppPingDelay_ms = 5000;

    function wcppDetectOnSuccess(){
        // WCPP utility is installed at the client side
        // redirect to WebClientPrint sample page

        // get WCPP version
        var wcppVer = arguments[0];
        if(wcppVer.substring(0, 1) == "3")
            window.location.href = '@Url.Action("Index")';
        else //force to install WCPP v3.0
            wcppDetectOnFailure();
    }

    function wcppDetectOnFailure() {
        // It seems WCPP is not installed at the client side
        // ask the user to install it
        $('#msgInProgress').hide();
        $('#msgInstallWCPP').show();
    }

    </script>


    @* WCPP detection script generated by HomeController *@

    @Html.Raw(ViewBag.WCPScript);


}